<?php


namespace app\api\controller;


class AddMysql
{
    public function del()
    {
        //获取门派
        $school = Db::name('school')->where('school_id', 1)->select();
        $esoterica = [
            1 => '册',
            2 => '天书',
            3 => '御法',
            4 => '攻决',
            5 => '身法',
            6 => '遁法',
            7 => '秘诀',
            8 => '心经',
            9 => '秘术',
        ];
        $es = [
            1 => [1 => 50, 2 => 50, 3 => 20, 4 => 25, 5 => 11, 6 => 5, 7 => 11, 8 => 10, 9 => 10],
            2 => [1 => 100, 2 => 100, 3 => 40, 4 => 50, 5 => 22, 6 => 10, 7 => 22, 8 => 20, 9 => 20],
            3 => [1 => 300, 2 => 300, 3 => 120, 4 => 150, 5 => 66, 6 => 30, 7 => 66, 8 => 60, 9 => 60],
            4 => [1 => 500, 2 => 500, 3 => 200, 4 => 250, 5 => 110, 6 => 50, 7 => 110, 8 => 100, 9 => 100],
            5 => [1 => 800, 2 => 800, 3 => 320, 4 => 400, 5 => 176, 6 => 80, 7 => 176, 8 => 160, 9 => 160],
            6 => [1 => 1000, 2 => 1000, 3 => 400, 4 => 500, 5 => 220, 6 => 100, 7 => 220, 8 => 200, 9 => 200],
            7 => [1 => 3000, 2 => 3000, 3 => 1200, 4 => 1500, 5 => 660, 6 => 300, 7 => 660, 8 => 600, 9 => 600],
            8 => [1 => 5000, 2 => 5000, 3 => 2000, 4 => 2500, 5 => 1100, 6 => 500, 7 => 1100, 8 => 1000, 9 => 1000],
            9 => [1 => 8000, 2 => 8000, 3 => 3200, 4 => 4000, 5 => 1760, 6 => 800, 7 => 1760, 8 => 1600, 9 => 1600],
            10 => [1 => 10000, 2 => 10000, 3 => 4000, 4 => 5000, 5 => 2200, 6 => 1000, 7 => 2200, 8 => 2000, 9 => 2000],
        ];
        //增加功法消耗资源
        $R = [0, 100, 300, 500, 1000, 3000, 5000, 10000, 13000, 15000, 20000];
        //升级功法
        $tt = [0, 0, 100, 300, 500, 1000, 3000, 5000, 10000, 30000, 50000, 100000];
        //消耗门贡灵石
        $lingshi = [
            1 => [0, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
            2 => [0, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
            3 => [0, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500],
            4 => [0, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000],
            5 => [0, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000],
            6 => [0, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000],
            7 => [0, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000],
            8 => [0, 30000, 30000, 30000, 30000, 30000, 30000, 30000, 30000, 30000, 30000],
            9 => [0, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000],
            10 => [0, 100000, 100000, 100000, 100000, 100000, 100000, 100000, 100000, 100000, 100000],
        ];
        
        $xiuwei = [
            1 => [0, 1000, 1500, 2000, 2500, 3000, 4200, 4700, 5200, 5700, 6200],
            2 => [0, 13280, 31560, 37400, 49840, 68120, 86400, 104680, 122960, 141240, 159520],
            3 => [0, 218600, 323622, 428644, 533666, 638688, 743710, 848732, 953754, 1058776, 1163800],
            4 => [0, 1542000, 1813733, 2085466, 2357199, 2628932, 2900665, 3172398, 3444131, 3755864, 3987600],
            5 => [0, 5076000, 6405600, 7735200, 9064800, 10394400, 11724000, 13053600, 14383200, 15712800, 17042400],
            6 => [0, 21324000, 25801333, 30278666, 34755999, 39233332, 43710665, 48187998, 52665331, 57142664, 61620000],
            7 => [0, 72456000, 93218666, 113981336, 134744006, 155506676, 176269346, 197032016, 217794686, 238557356, 259320000],
            8 => [0, 325400000, 375968888, 426537776, 477106664, 527675552, 578244440, 628813328, 679382216, 729951104, 780519992],
            9 => [0, 867320000, 1043222222, 1219124444, 1395026666, 1570928888, 1746831110, 192273332, 2098635554, 2274537776, 2450440000],
            10 => [0, 3015680000, 7506488888, 11997297776, 16488106664, 20978915552, 25469724440, 29960533328, 34451342216, 38942151104, 43432960000],
        ];
        
        $gngneng = [1 => '修炼速度', 2 => '生命', 3 => '防御', 4 => '攻击', 5 => '闪避', 6 => '速度', 7 => '暴击', 8 => '韧性', 9 => '命中'];
        foreach ($school as $key => $value) {
            foreach ($esoterica as $k => $v) {
                $n = 10;
                $f_id = 0;
                while ($n >= $value['level']) {
                    $i = 10;
                    while ($i >= 1) {
                        
                        $info = [
                            'name' => '《' . $value['name'] . $v . '》' . $n . '星' . $i . '重',
                            'price_id' => guid(),
                            'type' => $k,
                            'value' => $es[$n][$k],
                            'f_id' => $f_id,
                            'realm_id' => "",
                            'school_id' => $value['school_id'],
                            'steps' => $i,
                            'level' => $n,
                            'img_url' => '/static/api/img/esoterica/' . $k . '01.png',
                            'sell' => $n * 1000,
                            'describe' => $value['name'] . '功法，学习后' . $gngneng[$k] . '+' . $es[$n][$k],
                        ];
                        $f_id = Db::name('esoterica')->insertGetId($info);
                        
                        if ($i == 1 && ($n == $value['level'])) {
                            $price = [
                                [
                                    'price_id' => $info['price_id'],
                                    'type' => 4,
                                    'value' => $R[$n],
                                ],
                                [
                                    'price_id' => $info['price_id'],
                                    'type' => 6,
                                    'value' => $n * 100,
                                ],
                            ];
                        } else {
                            
                            $price = [
                                [
                                    'price_id' => $info['price_id'],
                                    'type' => 4,
                                    'value' => $lingshi[$n][$i],
                                ],
                                [
                                    'price_id' => $info['price_id'],
                                    'type' => 1,
                                    'value' => $lingshi[$n][$i],
                                ],
                                [
                                    'price_id' => $info['price_id'],
                                    'type' => 2,
                                    'value' => $xiuwei[$n][$i],
                                ],
                            ];
                        }
                        Db::name('price')->insertAll($price);
                        $i--;
                    }
                    $n--;
                }
            }
            
        }
    }
    
    
    public function llll()
    {
        $data = Db::name('esoterica')->select();
        foreach ($data as $value) {
            Db::name('price')->where('price_id', $value['price_id'])->delete();
            Db::name('esoterica')->where('esoterica_id', $value['esoterica_id'])->delete();
        }
    }
}